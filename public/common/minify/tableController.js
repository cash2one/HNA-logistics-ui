easySpa.use(["public/common/tableService.js","public/common/Event.js"],function(){app.controller("tableController",["$scope","tableService",function(a,e){a.table={},a.table.selectAll=function(a){if(a.selectFlag){a.tableBody=e.selectAll(a.tableBody);var t=e.selectNumberCount(a.tableBody);a.selectNumber=t.select}else a.tableBody=e.cancelAll(a.tableBody),a.selectNumber=0},a.table.selectOne=function(a,t,n){n&&n.stopPropagation(),a.tableBody=e.selectOne(a.tableBody,t);var r=e.selectNumberCount(a.tableBody);a.selectNumber=r.select,r.select==r.count?a.selectFlag=!0:(r.noselect,r.count,a.selectFlag=!1)},a.table.first=function(a){a.pagination.currentPage=1,a.restData.pageIndex=a.pagination.currentPage,a.restData.pageSize=a.pagination.pageSize,e.getTable(a.restURL,{urlParams:a.restData,seatParams:a.seatData},function(t){a=e.table(a,{urlParams:a.restData,seatParams:a.seatData},t)})},a.table.last=function(a){a.pagination.currentPage=a.pagination.totalPage,a.restData.pageIndex=a.pagination.currentPage,a.restData.pageSize=a.pagination.pageSize,e.getTable(a.restURL,{urlParams:a.restData,seatParams:a.seatData},function(t){a=e.table(a,{urlParams:a.restData,seatParams:a.seatData},t)})},a.table.previous=function(a){a.pagination.getPage=a.pagination.currentPage=a.pagination.currentPage-1,a.restData.pageIndex=a.pagination.currentPage,a.restData.pageSize=a.pagination.pageSize,e.getTable(a.restURL,{urlParams:a.restData,seatParams:a.seatData},function(t){a=e.table(a,{urlParams:a.restData,seatParams:a.seatData},t)})},a.table.nexts=function(a){a.pagination.getPage=a.pagination.currentPage=a.pagination.currentPage+1,a.restData.pageIndex=a.pagination.currentPage,a.restData.pageSize=a.pagination.pageSize,e.getTable(a.restURL,{urlParams:a.restData,seatParams:a.seatData},function(t){a=e.table(a,{urlParams:a.restData,seatParams:a.seatData},t)})},a.table.selectPage=function(a,t){t!=a.pagination.currentPage&&(a.pagination.getPage=t,a.pagination.currentPage=t,a.restData.pageIndex=t,a.restData.pageSize=a.pagination.pageSize,e.getTable(a.restURL,{urlParams:a.restData,seatParams:a.seatData},function(t){a=e.table(a,{urlParams:a.restData,seatParams:a.seatData},t)}))},a.table.goPage=function(a){var t=a.pagination.getPage;if(t&&t!=a.pagination.currentPage)return t<1||t>a.pagination.totalPage?void(a.pagination.getPage=a.pagination.currentPage):void(isNaN(t)?a.pagination.getPage=a.pagination.currentPage:(t>a.pagination.totalPage&&(t=a.pagination.totalPage),a.pagination.currentPage=t,a.restData.pageIndex=t,a.restData.pageSize=a.pagination.pageSize,e.getTable(a.restURL,{urlParams:a.restData,seatParams:a.seatData},function(t){a=e.table(a,{urlParams:a.restData,seatParams:a.seatData},t),a.pagination.getPage=a.pagination.currentPage})))},a.table.pageSize=function(a,t){a.pagination.pageSize=t,a.restData.pageIndex=1,a.restData.pageSize=a.pagination.pageSize,e.getTable(a.restURL,{urlParams:a.restData,seatParams:a.seatData},function(t){a=e.table(a,{urlParams:a.restData,seatParams:a.seatData},t)})},a.renderFinish=function(a){var e,t,n,r,i=[];if(a)r=$("table"),setTimeout(function(){for(var a=0;a<r.length;a++){var s=$(r[a]).outerWidth();if($(r[a]).is(":visible")){i=[],e=$("th",$(r[a]));for(var o=0;o<e.length;o++){var l=$(e[o])[0].style.width.split("%"),g=0,p=1;l.length>1?(p=parseInt(l[0]),g=s*p/100):g=$(e[o]).outerWidth(),$(e[o]).outerWidth(Math.floor(g)),$(e[o]).css({"min-width":"20px","max-width":Math.floor(g)+"px",width:Math.floor(g)+"px","word-wrap":"no-wrap","text-overflow":"ellipsis"}),i.push(Math.floor(g))}t=$("tr",$(r[a]));for(var u=1;u<t.length;u++){n=$("td",t[u]);for(var c=0;c<n.length;c++)$(n[c]).css({"min-width":"20px","max-width":Math.floor(i[c])+"px",width:Math.floor(i[c])+"px","word-wrap":"no-wrap",overflow:"hidden","text-overflow":"ellipsis"})}$(r[a]).css("visibility","visible")}}},200);else{r=$("table");for(var s=0;s<r.length;s++)$(r[s]).is(":visible")}};var t=null;Event.onResizend(function(){t||(t=setTimeout(function(){a.renderFinish(!0),t=null},100))}),window.resizeTable=function(){a.renderFinish(!0)}}])});