!function(){"use strict";function e(){var e=location.href.split("#");e.length>0&&e[1]&&(-1==e[1].indexOf("?")?$("#iframe")[0].src="iframe.html#"+e[1]+"?t="+(new Date).getTime():$("#iframe")[0].src="iframe.html#"+e[1]+"&t="+(new Date).getTime())}function a(e){var a=e.i18n;e=JSON.stringify(e),$.ajax({url:"/api/v1/u/userconfig",data:e,method:"POST",contentType:"application/json; charset=utf-8",success:function(e){0===e.errorCode&&(cookie.set("language",a,30),window.location.reload())}})}function i(e,a){for(var n="",o=0,s=e.length;o<s;o++){var l=e[o].children&&e[o].children.length;n+=1==a?'<li data-level="'+a+'" class="treeview">':'<li data-level="'+a+'">',n+=l?'<a href="javascript:void(0);">':'<a data-hash="'+e[o].url+'" class="url-link" href="'+e[o].url+'">',1==a?(n+='<i class="menu-icon-logo '+r[o]+'"></i>',n+='<span class="menu-info">'+e[o].name+"</span>"):n+=e[o].name,l&&(n+='<i class="icon-angle-right menu-has-child"></i>'),n+="</a>",l&&(n+='<ul class="treeview-menu">',n+=i(e[o].children,a+1),n+="</ul>"),n+="</li>"}return n}function n(){$.Frame.pushMenu={activate:function(e){$.Frame.options.screenSizes;$(document).on("click",e,function(e){e.preventDefault(),$("body").hasClass("sidebar-collapse")?($.Frame.options.sidebarOpen=!1,$("body").removeClass("sidebar-collapse"),$("#iframe").contents().find("body").removeClass("sidebar-collapse")):($.Frame.options.sidebarOpen=!0,$("body").addClass("sidebar-collapse"),$("#iframe").contents().find("body").addClass("sidebar-collapse"))})}},$.Frame.layout={activate:function(){var e=this;e.fixSidebar(),$(window).resize(function(){e.fixSidebar()})},fixSidebar:function(){if(!$("body").hasClass("fixed"))return void(void 0!==$.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto"));void 0===$.fn.slimScroll&&window.console&&window.console.error("Error: the fixed layout requires the slimscroll plugin!"),$.Frame.options.sidebarSlimScroll&&void 0!==$.fn.slimScroll&&($(".sidebar").slimScroll({destroy:!0}).height("auto"),$(".sidebar").slimscroll({height:$(".menu-sidebar").height()}))}},$.Frame.tree=function(e){var a=$.Frame.options.animationSpeed;$(document).off("click",e+" li a").on("click",e+" li a",function(i){var n=$(this),o=n.parent("li"),s=n.next(),l=$(".menu-has-child");if($("body").hasClass("sidebar-collapse"))return!1;if(s.is(".treeview-menu")&&s.is(":visible")){var t=n.parents("ul").first(),r=t.find("ul:visible").slideUp(a);l.each(function(){$(this).removeClass("icon-angle-down").addClass("icon-angle-right")}),o.hasClass("treeview")||n.parent("li").parents("li").children("a").children(".menu-has-child").removeClass("icon-angle-right").addClass("icon-angle-down"),s.slideUp(a,function(){s.removeClass("menu-open"),o.removeClass("active")})}else if(s.is(".treeview-menu")&&!s.is(":visible")){var t=n.parents("ul").first();t.find("li.active").removeClass("active"),o.addClass("active");var r=t.find("ul:visible").slideUp(a);r.removeClass("menu-open"),s.addClass("menu-open"),s.slideDown(a),l.each(function(){$(this).removeClass("icon-angle-down").addClass("icon-angle-right")}),n.parents("li").each(function(){$(this).children("a").children(".menu-has-child").removeClass("icon-angle-right").addClass("icon-angle-down")})}s.is(".treeview-menu")?i.preventDefault():($(e).find("li a.selected").removeClass("selected"),n.addClass("selected").siblings("li").removeClass("active"),s.is(".treeview-menu")||o.siblings("li").each(function(){$(this).removeClass("active"),$(this).children("a").children(".menu-has-child").removeClass("icon-angle-down").addClass("icon-angle-right"),$(this).children(".treeview-menu").removeClass(".menu-open").hide()}),o.is(".treeview")&&o.addClass("active"))})},$.Frame.mouseLeave={activate:function(e){$(document).off("click",e).on("mouseleave",e,function(e){e.preventDefault(),e.stopPropagation(),$.Frame.options.sidebarOpen&&($("body").addClass("sidebar-collapse"),$("#iframe").contents().find("body").addClass("sidebar-collapse"))}).on("mouseover",e,function(e){e.preventDefault(),e.stopPropagation(),$("body").hasClass("sidebar-collapse")&&($("body").removeClass("sidebar-collapse"),$("#iframe").contents().find("body").removeClass("sidebar-collapse"))})}},$.Frame.expendTree=function(e,a){if(!a||"#/"==a)return!1;$(e).find("a").each(function(){$(this).attr("href")==a&&($(this).addClass("selected"),$(this).parent("li").addClass("active"),$(this).parent("li").parents("ul").each(function(){$(this).css("display","block"),$(this).parent("li").addClass("active")}),$(this).parents("li").each(function(){$(this).children("a").children(".menu-has-child").removeClass("icon-angle-right").addClass("icon-angle-down")}))})}}window.isGoToPage=!0,window.onload=function(){e()},window.onhashchange=function(){isGoToPage=!0,e()},window.setIframeLayerMostHigh=function(){$("#iframe-box").css("z-index",1008)},window.resetIframeLayerZindex=function(){$("#iframe-box").css("z-index",1e3)},window.hideDropDownList=function(){$(".navbar-custom-menu .dropdown").removeClass("open")},$.extend({dropdown:function(e,a){$(e).click(function(a){$(this).hasClass("open")?$(e).removeClass("open"):($(e).removeClass("open"),$(this).addClass("open")),a.stopPropagation()}),$(document).click(function(){$(e).removeClass("open")})}}),$.dropdown(".dropdown");var o=cookie.get("token");$.ajaxSetup({headers:{"x-token":o},async:!0,cache:!0}),function(){$.ajax({url:"/api/v1/u/profile",success:function(e){if(0===e.errorCode){var i=e.data||{},n=null!=i.uc?i.uc.i18n:"";if(n&&n!=l)cookie.set("language",n,30),window.location.reload();else if(n){if($("#user-info span").text(i.fullName),i.avatarPath)var o=i.avatarPath;else var o="f"==i.sex?"public/img/avatar2.png":"public/img/avatar1.png";cookie.set("sex",i.sex),cookie.set("fullName",i.fullName),cookie.set("userId",i.userId),$("#user-info img").attr("src",o),$("#user-info").show()}else a({i18n:l})}else window.location.href="http://"+window.location.host+"/login.html#/login?errorCode=401"}})}();var s={"zh-CN":"简体中文","zh-HK":"繁體中文","en-US":"English"},l=cookie.get("language")?cookie.get("language"):"zh-CN",t=s[l];!function(){$("#language a span").text(t);var e="public/img/lang-"+l+".png";$("#language a img").attr("src",e);var i="";for(var n in s)i+='<li data-key="'+n+'" class="language'+(n==l?" active":"")+'">',i+='<img src="public/img/lang-'+n+'.png" class="image" width="29" height="21"/> ',i+=s[n]+"</li>";$("#language ul").html(i),$("#language li.language").click(function(e,i){$(this).hasClass("active")||a({i18n:$(this).data("key")})})}(),$("#logout").click(function(){$.ajax({url:"/api/v1/auth/logout",success:function(e){if(0===e.errorCode){cookie.delete("token"),cookie.delete("loginSuccess");try{var a=window.location.protocol,i=window.location.hostname,n=window.location.port;window.location.href=a+"//"+i+":"+n+"/login.html#/login"}catch(e){window.location.reload()}}}})}),$("#updatepd").click(function(){console.log("hihihihi"),window.location.href="http://"+window.location.host+"/#/updatePassword"}),function(){$.ajax({url:"/api/v1/u/usertree",success:function(e){if(0===e.errorCode)try{var a=i(e.data.children,1);$("#menu").html(a),$.Frame.expendTree(".sidebar",window.location.hash)}catch(e){}}})}();var r=["icon-System-management","icon-Data-management","icon-Logistics","icon-The-financial-management","icon-The-dashboard","icon-Customer-service","icon-male","icon-bug"];$.Frame={},$.Frame.options={sidebarSlimScroll:!1,sidebarOpen:!1,animationSpeed:500,sidebarToggleSelector:"[data-toggle='offcanvas']",mouseLeaveCanvas:"[data-toggle='leaveAside']",screenSizes:{xs:480,sm:768,md:992,lg:1200}},$(function(){var e=$.Frame.options;n(),$.Frame.layout.activate(),$.Frame.tree(".sidebar"),$.Frame.pushMenu.activate(e.sidebarToggleSelector),$.Frame.mouseLeave.activate(e.mouseLeaveCanvas)})}();