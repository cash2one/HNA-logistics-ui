function checkWeight(e){return!e||!!/^(\d{1}|[1-9][0-9]*)$|^(0{1}|[1-9][0-9]*)\.\d{1,3}$/.test(e)}app.constant("REGEXP",{SUPPLIERNAME:/^([\w\u4E00-\u9FA5_\-\(\)\（\）\s.&,]+)+$/,GOODSNAME:/^([\w\u4E00-\u9FA5_\-\(\)\（\）\s.,]+)+$/,PRICE:/^[0-9]+(.[0-9]{1,2})?$/,TOTALPRICE:/^[0-9]+(.[0-9]{1,4})?$/,POSITIVEINTEGER:/^[0-9]*[1-9][0-9]*$/,IMOCODE:/^([\w]+)+$/,ORDERNUMBER:/^([\w\u4E00-\u9FA5_\-.]+)+$/,TEMPLATENAME:/^([\w\u4E00-\u9FA5_\-\,\s.]+)+$/,ONLYNAME:/^([\w\u4E00-\u9FA5_\-\(\)\（\）\s]+)+$/,NAMEEN:/^([\w_\-\(\)\（\）\s]+)+$/,NAMECN:/^([\u4E00-\u9FA5_\-\(\)\（\）\d]+)+$/,NAME:/^([\w\u4E00-\u9FA5_\-]+)+$/,NAMESPACE:/^([\w\u4E00-\u9FA5_\-\s]+)+$/,CODE:/^([\w_\-]+)+$/,carrierCode:/^([A-Za-z\d\-\&\.\,\(\)\s]+)+$/,CODEWITHBLANK:/^([\w_\-\s]+)+$/,PHONE:/^([\d_\-\+]+)+$/,NUMBER:/^\d+(\.\d+)?$/,EMAIL:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,triadCode:/^[A-Za-z]+$/,PAYLOAD:/^(\d{1}|[1-9][0-9]*)$|^(0{1}|[1-9][0-9]*)\.\d{1,3}$/,noZeroInt:/^[1-9]\d+$/,floatTwo:/^(\d{1}|[1-9][0-9]*)$|^(0{1}|[1-9][0-9]*)\.\d{1,2}$/,noZeroFloatTwo:/^[1-9][0-9]*$|^([1-9][0-9]*)\.\d{1,2}$|^[0]\.[1-9]\d*$|^[0]\.[0][1-9]$/,floatFour:/^(\d{1}|[1-9][0-9]*)$|^(0{1}|[1-9][0-9]*)\.\d{1,4}$/,phoneNumber:/^1(3|5|6|7|8|9)\d{9}$/,numberPrefix:/^([A-Za-z\d\#\*\!]+)+$/,seriesWNumber:/^([\d\*]+)\?{1}$|^(\d*\?{1}\-\d*\?{1})$/,seriesNumber:/^([\d\*\?]+)$|^(\d*\?{0,1}\d*\-\d*\?{0,1}\d*)$/}).value("CONFIG",{maxThirty:30,maxFifteen:15,tipsShow:!1}).directive("ngEnter",function(){return function(e,i,t){i.bind("keydown keypress",function(i){13===i.which&&(e.$apply(function(){e.$eval(t.ngEnter)}),i.preventDefault())})}}).directive("ngConversion",function(){return function(e,i,t,r){i.bind("keyup",function(e){i.val()&&e.which>=65&&e.which<=90&&("lowercase"==t.ngConversion?i.val(i.val().toLowerCase()):"uppercase"==t.ngConversion&&i.val(i.val().toUpperCase()))})}}).directive("verification",["REGEXP","CONFIG",function(REGEXP,CONFIG){return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ctrl){var tipsPrefix=Lang.getValByKey("common","common_code_pleinput"),tipsOne=Lang.getValByKey("common","common_code_tipsOne"),tipsTwo=Lang.getValByKey("common","common_code_tipsTwo"),tipsThree=Lang.getValByKey("common","common_code_tipsThree"),tipsFour=Lang.getValByKey("common","common_code_tipsFour"),tipsErrFormat=Lang.getValByKey("common","common_code_errformat"),verifiValue={};elm.bind("focus",function(){verifiValue=angular.fromJson(attrs),verifiValue=eval("("+verifiValue.verification+")"),scope.$apply(function(){if(verifiValue.maxType?"15"==verifiValue.maxType?ctrl.maxLength=verifiValue.maxLength||CONFIG.maxFifteen:"30"==verifiValue.maxType&&(ctrl.maxLength=verifiValue.maxLength||CONFIG.maxThirty):ctrl.maxLength=verifiValue.maxLength||CONFIG.maxThirty,verifiValue.tipsShow=void 0==verifiValue.tipsShow?CONFIG.tipsShow:verifiValue.tipsShow,verifiValue.tipsShow)switch(verifiValue.tipsType){case"one":ctrl.tips=tipsOne;break;case"two":ctrl.tips=tipsTwo;break;case"three":ctrl.tips=tipsThree;break;default:ctrl.tips=verifiValue.tipsMsg||tipsOne}ctrl.info=!0})}).bind("blur",function(){scope.$apply(function(){ctrl.info=!1})}),ctrl.$validators.defined=function(modelValue,viewValue){if(ctrl.$isEmpty(modelValue))return!0;if(verifiValue.ruleReg&&verifiValue.ruleRegMsg){if(verifiValue.ruleReg=eval(verifiValue.ruleReg),!verifiValue.ruleReg.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg||tipsErrFormat,!1;ctrl.errorTips=""}else if(verifiValue.ruleType)switch(verifiValue.ruleType){case"namespace":if(!REGEXP.NAMESPACE.test(viewValue))return ctrl.errorTips="请输入中英文、数字、空格和符号“-”、“_”",!1;break;case"goodsname":if(!REGEXP.GOODSNAME.test(viewValue))return ctrl.errorTips="请输入中英文、数字、空格和符号“-”、“_”、“.”、“（”、“）”、“(”、“)”、“,”",!1;break;case"suppliername":if(!REGEXP.SUPPLIERNAME.test(viewValue))return ctrl.errorTips="请输入中英文、数字、空格和符号“-”、“_”、“.”、“（”、“）”、“(”、“)”、“&”",!1;break;case"price":if(!REGEXP.PRICE.test(viewValue))return ctrl.errorTips="请输入数字，最多仅支持2位小数",!1;break;case"totalprice":if(!REGEXP.TOTALPRICE.test(viewValue))return ctrl.errorTips="请输入数字，最多仅支持4位小数",!1;break;case"positiveinteger":if(!REGEXP.POSITIVEINTEGER.test(viewValue))return ctrl.errorTips="请输入正整数",!1;break;case"imocode":if(!REGEXP.IMOCODE.test(viewValue))return ctrl.errorTips="请输入英文、数字",!1;break;case"ordernumber":if(!REGEXP.ORDERNUMBER.test(viewValue))return ctrl.errorTips="请输入中英文、数字、“.”、“-”、“_”",!1;break;case"templatename":if(!REGEXP.TEMPLATENAME.test(viewValue))return ctrl.errorTips="请输入中英文、数字、“.”、“-”、“_”、空格、“,”",!1;break;case"onlyname":if(!REGEXP.ONLYNAME.test(viewValue))return ctrl.errorTips="请输入中英文、数字、空格和符号 “-”、“_”、“(”、“)”、“（”、“）” ",!1;break;case"nameen":if(!REGEXP.NAMEEN.test(viewValue))return ctrl.errorTips="请输入英文、数字、“-_()（）”、空格",!1;break;case"namecn":if(!REGEXP.NAMECN.test(viewValue))return ctrl.errorTips="请输入中文、数字、“-_()（）”",!1;break;case"name":if(!REGEXP.NAME.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg||tipsPrefix+tipsOne,!1;break;case"code":if(!REGEXP.CODE.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg||tipsPrefix+tipsTwo,!1;break;case"carrierCode":if(!REGEXP.carrierCode.test(viewValue))return ctrl.errorTips="请输入英文、数字、空格和符号 “-”、“&”、“(”、“)”、“.”、“,” ",!1;break;case"codewithblank":if(!REGEXP.CODEWITHBLANK.test(viewValue))return ctrl.errorTips="请输入大小写英文、数字和符号-、_、空格",!1;break;case"email":if(!REGEXP.EMAIL.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg||tipsFour,!1;break;case"phone":case"number":if(!REGEXP.PHONE.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg||tipsPrefix+tipsThree,!1;break;case"payload":if(!REGEXP.PAYLOAD.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg,!1;break;case"floatTwo":if(!REGEXP.floatTwo.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg,!1;break;case"floatFour":if(!REGEXP.floatFour.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg,!1;break;case"phoneNumber":if(!REGEXP.phoneNumber.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg,!1;break;case"emailNumber":if(!REGEXP.emailNumber.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg||tipsFour,!1;break;case"numberPrefix":if(!REGEXP.numberPrefix.test(viewValue))return ctrl.errorTips=verifiValue.ruleRegMsg,!1;break;case"seriesWNumber":if(!REGEXP.seriesWNumber.test(viewValue))return ctrl.errorTips="请按已选规则输入*-?或数字",!1;break;case"seriesNumber":if(!REGEXP.seriesNumber.test(viewValue))return ctrl.errorTips="请按已选规则输入*-?或数字",!1}return!0}}}}]).directive("hnapagination",[function(){return{restrict:"EA",templateUrl:"tpl/public/pagination.html",scope:{pageTable:"=pageTableModel",table:"=tableService"},replace:!0,link:function(e){e.total=Lang.getValByKey("common","common_pagination_total"),e.piecedata=Lang.getValByKey("common","common_pagination_piecedata"),e.perPage=Lang.getValByKey("common","common_pagination_perPage"),e.piece=Lang.getValByKey("common","common_pagination_piece"),e.home=Lang.getValByKey("common","common_pagination_home"),e.prev=Lang.getValByKey("common","common_pagination_prev"),e.next=Lang.getValByKey("common","common_pagination_next"),e.last=Lang.getValByKey("common","common_pagination_last"),e.go=Lang.getValByKey("common","common_pagination_go"),e.page=Lang.getValByKey("common","common_pagination_page"),e.confirm=Lang.getValByKey("common","common_pagination_confirm")}}}]).directive("fileModel",["$parse","$rootScope",function(e,i){return{restrict:"A",link:function(t,r,n,a){if(n.multiple)r.bind("change",function(e){var i=[];t.$apply(function(){if(n.multiple)for(var e=0,t=r[0].files.length;e<t;e++)i.push(r[0].files[e])}),t.getFile(i,e)});else{var o=e(n.fileModel),l=o.assign;r.bind("change",function(e){t.$apply(function(){l(t,r[0].files[0]),l(i,r[0].files[0])}),t.file=(e.srcElement||e.target).files[0],t.getFile(e)})}}}}]).directive("fileNew",["$parse",function(e){return{restrict:"A",link:function(i,t,r,n){var a=e(r.fileNew),o=a.assign;t.bind("change",function(e){i.$apply(function(){o(i,t[0].files[0])}),i.file=(e.srcElement||e.target).files[0],i.updateFile()})}}}]).constant("RULES",{validate:{name:/^([\w\u4E00-\u9FA5_\-]+)+$/,surname:/^([A-Za-z\s\u4E00-\u9FA5]+)+$/,code:/^([\w_\-]+)+$/,phone:/^([\d_\-\+]+)+$/,mobilephone:/^1[356789]\d{9}$/,email:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,triadCode:/^[A-Za-z]+$/,number:/^\d+(\.\d+)?$/,letterAndNum:/^[A-Za-z0-9]+$/,float:/^\d+(\.\d{1,3})?$/,floatTwo:/^(\d{1}|[1-9][0-9]*)$|^(0{1}|[1-9][0-9]*)\.\d{1,2}$/,noZeroFloatTwo:/^[1-9][0-9]*$|^([1-9][0-9]*)\.\d{1,2}$|^[0]\.[1-9]\d*$|^[0]\.[0][1-9]$/,floatThree:/^(\d{1}|[1-9][0-9]*)$|^(0{1}|[1-9][0-9]*)\.\d{1,3}$/,floatFour:/^(\d{1}|[1-9][0-9]*)$|^(0{1}|[1-9][0-9]*)\.\d{1,4}$/,fix:/^([\d\s\-\+\(\)]+)+$/}}).directive("validateCode",["RULES",function(RULES){return{restrict:"A",require:"ngModel",replace:!0,link:function(scope,elm,attrs,ctrl){var verifiValue={};verifiValue=angular.fromJson(attrs),verifiValue.validateCode=eval("("+verifiValue.validateCode+")"),verifiValue.validateCode.maxLength&&elm.attr("maxLength",verifiValue.validateCode.maxLength),elm.bind("focus",function(){scope.$apply(function(){ctrl.tips=verifiValue.validateCode.ruleRegMsg,ctrl.info=!0})}).bind("blur",function(){scope.$apply(function(){ctrl.info=!1})}),ctrl.$validators.defined=function(modelValue,viewValue){if(ctrl.$isEmpty(modelValue))return!0;if(verifiValue.validateCode.ruleReg){var ruleReg=verifiValue.validateCode.ruleReg,keys=[];for(var key in RULES.validate)keys.push(key);if(-1!=ruleReg.indexOf("/")){if(!eval(ruleReg).test(viewValue))return ctrl.errorTips=verifiValue.validateCode.ruleRegMsg,!1}else for(var i in keys)if(ruleReg==keys[i]&&!RULES.validate[ruleReg].test(viewValue))return ctrl.errorTips=verifiValue.validateCode.ruleRegMsg,!1}return!0}}}}]).directive("validatetip",[function(){return{restrict:"EA",templateUrl:"tpl/public/validate.html",scope:{validate:"=fromModel"},replace:!0,link:function(e){}}}]).directive("remark",[function(){return{restrict:"EA",replace:!0,templateUrl:"tpl/public/remark.html",scope:{description:"="},link:function(e,i,t){e.textareaNumber=140,e.showTextNumber=function(){e.textareaNumber=140-e.description.length},e.word=Lang.getValByKey("common","common_page_remark_number")}}}]).directive("myDrag",function(){return{restrict:"A",link:function(e,i,t){var r=0;i.on("mousedown",function(e){var i=this;return r=e.pageY-$(this).offset().top,$(document).on("mousemove",function(e){$(i).css("top",e.pageY-r)}),$(document).on("mouseup",function(){$(document).off()}),!1})}}}).directive("textLength",[function(){return{restrict:"EA",require:"ngModel",replace:!0,link:function(e,i,t,r){i.bind("focus",function(){e.$apply(function(){i.parent().find(".text-legth").remove(),i.after('<div class="text-legth">'+(140-i.val().length)+Lang.getValByKey("common","common_page_remark_number")+"</div>")})}),i.on("keyup",function(){var t=i.val();e.$apply(function(){if(t.length){i.parent().find(".text-legth").remove();var e=140-t.length<0?0:140-t.length;i.after('<div class="text-legth">'+e+Lang.getValByKey("common","common_page_remark_number")+"</div>")}else i.parent().find(".text-legth").remove(),i.after('<div class="text-legth">140'+Lang.getValByKey("common","common_page_remark_number")+"</div>")})}),i.on("change",function(){var t=i.val();e.$apply(function(){if(t.length){i.parent().find(".text-legth").remove();var e=140-t.length<0?0:140-t.length;i.after('<div class="text-legth">'+e+Lang.getValByKey("common","common_page_remark_number")+"</div>")}})}),i.on("cut paste",function(){var t=$(this);e.$apply(function(){setTimeout(function(){var e=$(t).val();if(e.length){i.parent().find(".text-legth").remove();var r=140-e.length<0?0:140-e.length;i.after('<div class="text-legth">'+r+Lang.getValByKey("common","common_page_remark_number")+"</div>")}},100)})}),i.bind("blur",function(){e.$apply(function(){i.parent().find(".text-legth").remove()})})}}}]).directive("textLength2",[function(){return{restrict:"EA",require:"ngModel",replace:!0,link:function(e,i,t,r){i.bind("focus",function(){e.$apply(function(){i.parent().find(".text-legth").remove(),i.after('<div class="text-legth">'+(200-i.val().length)+Lang.getValByKey("common","common_page_remark_number")+"</div>")})}),i.on("keyup",function(){var t=i.val();e.$apply(function(){if(t.length){i.parent().find(".text-legth").remove();var e=200-t.length<0?0:200-t.length;i.after('<div class="text-legth">'+e+Lang.getValByKey("common","common_page_remark_number")+"</div>")}else i.parent().find(".text-legth").remove(),i.after('<div class="text-legth">200'+Lang.getValByKey("common","common_page_remark_number")+"</div>")})}),i.on("change",function(){var t=i.val();e.$apply(function(){if(t.length){i.parent().find(".text-legth").remove();var e=200-t.length<0?0:200-t.length;i.after('<div class="text-legth">'+e+Lang.getValByKey("common","common_page_remark_number")+"</div>")}})}),i.on("cut paste",function(){var t=$(this);e.$apply(function(){setTimeout(function(){var e=$(t).val();if(e.length){i.parent().find(".text-legth").remove();var r=200-e.length<0?0:200-e.length;i.after('<div class="text-legth">'+r+Lang.getValByKey("common","common_page_remark_number")+"</div>")}},100)})}),i.bind("blur",function(){e.$apply(function(){i.parent().find(".text-legth").remove()})})}}}]).directive("valiateWeight",function(){return{restrict:"EA",require:"ngModel",link:function(e,i,t,r){function n(i,t){if(e.weightLimitMsg="",o("weightLimitMin"),o("weightLimitMax"),null==e.weightLimitMin&&(e.weightLimitMin=""),null==e.weightLimitMax&&(e.weightLimitMax=""),"string"==typeof i||"number"==typeof i){if(""===e.weightLimitMin&&""===e.weightLimitMax)return e.weightLimitMsg="",e.canSubmit=!0,o("weightLimitMin"),void o("weightLimitMax");if(!checkWeight(e.weightLimitMin)&&"min"===t)return e.weightLimitMsg="请输入数字，保留三位小数",void a("weightLimitMin");if(!checkWeight(e.weightLimitMax)&&"min"===t)return e.weightLimitMsg="请输入数字，保留三位小数",void a("weightLimitMax");if(!checkWeight(e.weightLimitMax)&&"max"===t)return e.weightLimitMsg="请输入数字，保留三位小数",void a("weightLimitMax");if(!checkWeight(e.weightLimitMin)&&"max"===t)return e.weightLimitMsg="请输入数字，保留三位小数",void a("weightLimitMin");if(!checkWeight(e.weightLimitMin)&&e.weightLimitMax)return e.weightLimitMsg="请输入下限值",void a("weightLimitMin");if(!checkWeight(e.weightLimitMax)&&e.weightLimitMin)return e.weightLimitMsg="请输入上限值",void a("weightLimitMax");checkWeight(e.weightLimitMin)&&checkWeight(e.weightLimitMax)&&parseFloat(e.weightLimitMin)>=parseFloat(e.weightLimitMax)&&(e.weightLimitMsg="下限值必须小于上限值",a("weightLimitMin"),a("weightLimitMax"))}else a("weightLimitMin"),a("weightLimitMax")}function a(i){$('input[name="'+i+'"]').addClass("ng-invalid ng-dirty"),e.canSubmit=!1}function o(i){$('input[name="'+i+'"]').removeClass("ng-invalid ng-dirty"),e.canSubmit=!0}e.$watch("weightLimitMin",function(e){n(e,"min")}),e.$watch("weightLimitMax",function(e){n(e,"max")}),e.canSubmit=!0}}}).directive("formatEnt",function(e){return{require:"ngModel",link:function(i,t,r,n){n.$parsers.push(function(i){return e(i)}),n.$formatters.push(function(i){return e(i)})}}});