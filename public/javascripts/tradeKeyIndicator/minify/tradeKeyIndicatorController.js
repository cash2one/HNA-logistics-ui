easySpa.require(["widget/slimscroll","public/common/tableController.js"],function(){app.controller("tradeKeyIndicatorCtrl",["$scope","tradeKeyIndicatorService","tradeKeyIndicatorView","tableService",function(e,a,t,o){function r(){$(".table-container tbody").slimscroll({height:$(".content-main").height()-250})}function n(){e.modifyId="",e.keyName="",e.overdueRate="",e.turnoverDays="",e.annualizedRate=""}function d(){return e.keyName||e.keyIndicator.keyName.$setDirty(),e.overdueRate||e.keyIndicator.overdueRate.$setDirty(),e.turnoverDays||e.keyIndicator.turnoverDays.$setDirty(),e.annualizedRate||e.keyIndicator.annualizedRate.$setDirty(),!!e.keyIndicator.$valid}e.tableModel={tableBody:[],restURL:"logistics.getAllTradeKeyIndicator",restData:{pageIndex:1,pageSize:10}},$(window).on("resize",r),e.loadListData=function(){var a={urlParams:e.tableModel.restData};o.getTable(e.tableModel.restURL,a,function(t){0===t.errorCode&&(e.tableModel=o.table(e.tableModel,a,t),setTimeout(function(){r(),e.$apply()},500))})},e.loadListData(),e.add=function(){n(),e.showPrompt=!0},e.close=function(){window.location.reload()},e.save=function(){d()&&(e.modifyId?a.modifyTradeKeyIndicator({seatParams:{id:e.modifyId},urlParams:{id:e.modifyId,projectName:e.keyName,overdueRate:e.overdueRate,turnoverDay:e.turnoverDays,annualizedReturn:e.annualizedRate}},function(a){0===a.errorCode&&(alert(a.msg),e.loadListData())}):a.addTradeKeyIndicator({urlParams:{projectName:e.keyName,overdueRate:e.overdueRate,turnoverDay:e.turnoverDays,annualizedReturn:e.annualizedRate}},function(a){0===a.errorCode&&(alert(a.msg),e.loadListData())}),e.showPrompt=!1)},e.modify=function(a){e.modifyId=a.id,e.keyName=a.projectName,e.overdueRate=a.overdueRate,e.turnoverDays=a.turnoverDay,e.annualizedRate=a.annualizedReturn,e.showPrompt=!0},e.del=function(a){e.deleteId=a,e.confirmDelete=!0},e.cancel=function(){window.location.reload()},e.confirmDel=function(){var t=[];t.push(e.deleteId),a.delTradeKeyIndicator({urlParams:t},function(a){0===a.errorCode&&(alert(a.msg),e.loadListData())}),e.confirmDelete=!1}}])});