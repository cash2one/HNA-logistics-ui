app.factory("contractTemplatesView",["tableService","contractTemplatesService",function(e,t){return{setScroll:function(){$(".table-container tbody").slimScroll({height:$(".content-main").height()-330})},initStateSelect:function(e){var a=t.getContractType();a.data.splice(0,0,{code:null,message:"全部"}),selectFactory({data:a,id:"serviceType",showTextField:"message",defaultText:null,attrTextModel:function(t,a,o){t?(e.serviceType=o.message,e.serviceTypeCode=o.code):e.serviceTypeCode=null,e.$apply()}})},initCalander:function(){Calander.init({ele:["#begin-time","#finish-time"]})},initTable:function(e){e.tableModel={tableHeader:[Lang.getValByKey("common","common_thead_number"),"业务类型","模板名称","创建人","创建时间"],tableHeaderSize:["15%","20%","20%","20%","20%"],tableBody:[],restURL:"logistics.getContractTemplate",restData:{sort:"createTime",q:"",pageIndex:1,pageSize:10,asc:!1},selectNumber:0,selectFlag:!1},e.loadData()},bindEvent:function(a){a.clearData=function(){a.serviceType="全部",a.serviceTypeCode=void 0,a.templateName=void 0,a.creater=void 0,$("#begin-time").val(""),$("#finish-time").val(""),a.search()},a.search=function(){a.tableModel.restData.startTime=$("#begin-time").val(),a.tableModel.restData.endTime=$("#finish-time").val(),a.tableModel.restData.serviceType=a.serviceTypeCode,a.tableModel.restData.name=a.templateName,a.tableModel.restData.createUserName=a.creater,a.loadData()},a.createContractTemplate=function(){top.location.href="http://"+location.host+"#/contractTemplateDetail"},a.deleteContractTemplate=function(){if(0!=a.tableModel.selectNumber&&0!=$(".table-box tbody tr").length){var o=[],n=e.getSelectTable(a.tableModel.tableBody);if(!n.length)return $(document).promptBox({isDelay:!0,contentDelay:Lang.getValByKey("common","common_code_noSelected"),type:"errer",manualClose:!0}),!1;angular.forEach(n,function(e){o.push(e.id)}),$(document).promptBox({title:Lang.getValByKey("common","common_prompt_title"),type:"warning",content:{tip:"是否确认删除该合同模板？"},operation:[{type:"submit",description:Lang.getValByKey("common","common_page_delete"),application:"delete",operationEvent:function(){t.delContractTemplate(o,function(e){0===e.errorCode?($(document).promptBox({isDelay:!0,contentDelay:e.msg,type:"success",time:3e3}),$(document).promptBox("closePrompt"),a.loadData()):$(document).promptBox({isDelay:!0,contentDelay:e.msg,type:"errer",manualClose:!0})})}}]})}else $(document).promptBox({isDelay:!0,contentDelay:Lang.getValByKey("common","common_code_noSelected"),type:"errer",manualClose:!0})}}}}]);