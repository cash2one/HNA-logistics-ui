easySpa.require(["service/templateService"],function(){function e(e,r,t,o){function n(r){console.log(r,"data"),r.orderStatusCode==a?(e.orderOut=!0,e.out=r,e.orderButtonName="确认发货",e.simOrderStatus="out"):r.orderStatusCode!=i&&4!=r.orderStatusCode||(e.orderIn=!0,e.inn=r,e.orderButtonName="确认收货",e.simOrderStatus="in"),e.orderStatusName=r.orderStatusName}var i=3,a=2;"SALE"===e.orderType?customerType=1:customerType=2,e.searchOneOrder=function(){if(!e.orderNo)return void e.form7.orderNo.$setDirty();r.getOrderStatusByOrderNo(e.orderNo,customerType).then(function(r){e.orderIn=e.orderOut=!1,e.out={},e.inn={},e.orderButtonName="",e.orderStatusName="",e.simOrderStatus="",0==r.errorCode?n(r.data||{}):t.promptBox({msg:r.msg})})},e.presentOrderNo&&(e.orderNo=e.presentOrderNo,e.searchOneOrder()),e.save=function(){if("in"===e.simOrderStatus){var n=angular.copy(e.inn);delete n.id,r.confirmTrdDeliveryOrder(n).then(function(r){Template.build(o,2,e.orderNo,function(o){t.promptBox({msg:r.msg}),e.goBack("fresh"),e.getDetail("sdetail",e.orderNo)})})}else if("out"===e.simOrderStatus){var n=angular.copy(e.out);delete n.id,r.confirmTrdOrder(n).then(function(r){0==r.errorCode&&Template.build(o,1,e.orderNo,function(o){t.promptBox({msg:r.msg}),e.getDetail("sdetail",e.orderNo)})})}},setTimeout(function(){Calander.init({ele:"#InnReceiptTime",isClear:!0}),Calander.init({ele:"#innPaymentTime",isClear:!0}),Calander.init({ele:["#outtransportStartTime","#outtransportEndTime"],isClear:!0}),Calander.init({ele:["#outsailStartTime","#outsailEndTime"],isClear:!0}),Calander.init({ele:["#outreachStartTime","#outreachEndTime"],isClear:!0})},0),e.add=function(e){e.push({}),console.log(e,"orderGoods")},e.delete=function(e,r){e.forEach(function(t,o){t===r&&e.splice(o,1)})},e.edit=function(r,o){r.isEdit=!r.isEdit,setTimeout(function(){t.initNgSelect(e,"#goodsUnitName"+o,e.weightList,function(e){r.goodsUnitName=e.name,r.goodsUnit=e.code}),t.initNgSelect(e,"#goodsCurrencyTypeName"+o,e.currencyList,function(e){r.goodsCurrencyTypeName=e.name,r.goodsCurrencyType=e.code})},0)},r.weight().then(function(r){e.weightList=r.data}),r.currency().then(function(r){e.currencyList=r.data})}app.controller("simulateController",["$scope","tradeOrdersService","tradeOrdersView","templateService",e])});