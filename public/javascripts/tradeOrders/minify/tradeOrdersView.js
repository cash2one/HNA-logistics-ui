app.factory("tradeOrdersView",["$http","$templateCache","$compile",function(n,t,e){function i(){return"?a="+Math.random()}var o={};o.getTpl=function(e){return n.get("/tpl/fragment/tradeOrders/"+e+".html"+i()).then(function(n){if(n.data)return t.put(e+".html",n.data),n.data})};var r=$(document);return o.promptBox=function(n){var t={isDelay:!0,contentDelay:n.msg,time:3e3};0==n.errorCode?t.type="success":(t.manualClose=!0,t.type="errer"),r.promptBox(t),!t.time||r.promptBox("closePrompt")},o.promptMidBox=function(n,t,e,i,o,a,c){r.promptBox({title:n||"提示信息",type:o||"success",width:"400px",content:{tip:t.msg},cancelDescription:c,operation:[{type:"submit",application:a,description:e||Lang.getValByKey("common","common_pagination_confirm"),operationEvent:function(){return i(),!1}}]})},o.resetKeys=function(n,t){for(var e in t)delete n[e]},o.goodsTypes=function(n,t,i,o){function r(n,t){var e="<ul>";return n.forEach(function(n){e+='<li><p><input type="radio" style="left:'+(-30-15*t)+'px" name="goodType" ng-click="gchange(\''+n.name+"','"+n.id+'\')" ng-model="goodType" value="'+n.id+'" /><span>'+n.name+"</span></p></li>",n.children&&n.children.length>0&&(e+=r(n.children,t+1))}),e+="</ul>"}var a,c;i.id&&(t.goodType=c=i.id),i.name&&(a=i.name);var l='<div class="good-type" id="goodTypeDiv"><div><strong>选择商品类别</strong><div class="good-type-div">'+r(n,0)+'</div><div class="good-type-btn"><button class="btn btn-primary btn-bill" ng-click="gconfirm()">确定</button><button class="btn btn-primary btn-bill" ng-click="gcancel()">取消</button></div></div></div>',p={gconfirm:function(){o(a,c),t.gcancel()},gcancel:function(){$("#goodTypeDiv").remove()},gchange:function(n,t){a=n,c=t}};t.gconfirm||$.extend(t,p),$("#commodityList").append(e(l)(t))},o.initNgSelect=function(n,t,i,o){var r='<ul class="hide">',t=$(t),a=n.$new();i.forEach(function(n){r+="<li ng-click='selectOne("+JSON.stringify(n)+",$event)'>"+n.name+"</li>"}),r+="</ul>",a.selectOne=function(n,e){e.stopPropagation(),t.find("ul").hide(),o(n)},0===t.find("ul").length&&t.append(e(r)(a)),t.find("input").unbind("click").bind("click",function(n){n.stopPropagation();var e=t.find("ul");e.is(":hidden")?e.show():e.hide()}),window.initNgSelect||($(document.body).click(function(){$(".ng-select ul").hide()}),window.initNgSelect=!0)},o.DataFormat=function(n){var t=n.split(" ")[0].split("-"),e=t[0],i=t[1];return t[2]+"-"+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][parseInt(i-1,10)]+"-"+e},o.DataFormat2=function(n){var t=n.split(" ")[0].split("-"),e=t[0],i=t[1];return t[2]+" "+["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(i-1,10)]+", "+e},o.StringInsertByInterval=function(n,t,e){if(n){var i="(.{"+e+"}|.*)",o=new RegExp(i,"g"),r=n.match(o);r.pop();for(var a=(r.length,0);a<r.length;a+=2)r.splice(a+1,0,t);r.pop();return r.join("")}},o.SectionBreakWord=function(n,t){if(n){t||(t=90);var e=n.split("\n"),i=[];return angular.forEach(e,function(n){var e=o.SentenceBreakWord(n,t);i.push(e)}),i.join("\n")}},o.SentenceBreakWord=function(n,t){if(n){t||(t=90);var e=n.split(" "),i=[],r=0,a=0;for(a=0;a<e.length;a++)if(e[a].length>t){var c=o.StringInsertByInterval(e[a],"\n",t),l=c.split("\n");angular.forEach(l,function(n,e){n.length===t?i.push(n+"\n"):(i.push(n+" "),r+=n.length+1)})}else r+=e[a].length,r>t?(i.push("\n"+e[a]+" "),r=e[a].length+1):(i.push(e[a]+" "),r++);return i.join("")}},o}]);