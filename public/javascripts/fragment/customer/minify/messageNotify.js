app.controller("customerMessageNotifyCtrl",["$scope","customerService","tableService",function(e,t,o){function s(e,t){return 0==e.length&&0!=t.length?($(document).promptBox({isDelay:!0,contentDelay:"请至少选择一种通知方式！",type:"errer",manualClose:!0}),!1):0!=e.length&&0==t.length?($(document).promptBox({isDelay:!0,contentDelay:"请至少选择一个通知节点！",type:"errer",manualClose:!0}),!1):void 0}e.IsEdit=!1,e.editMessageNotify=function(){e.IsEdit=!e.IsEdit,$(".subContainer input:checkbox").attr("disabled",!1)},e.save=function(){var o=[],n=[];!0===e.notifyMethod[0].selected&&o.push("sms"),!0===e.notifyMethod[1].selected&&o.push("email");for(var a=0;a<e.notifyNodeType.length;a++)!0===e.notifyNodeType[a].selected&&n.push(e.notifyNodeType[a].id);if(!1!==s(o,n)){var r={seatParams:{customerId:e.customerId},urlParams:[{refIds:n,sendTypes:o,refParentId:1}]};t.saveMessageNotify(r,function(t){0!=t.errorCode?$(document).promptBox({isDelay:!0,contentDelay:t.msg,type:"errer",manualClose:!0}):($(document).promptBox({isDelay:!0,contentDelay:t.msg,type:"success",time:3e3}),e.IsEdit=!e.IsEdit,$(":checkbox").attr("disabled",!0))})}},e.$on("messageNotifyEvent",function(o,s){e.IsEdit=!1;var n={seatParams:{customerId:e.customerId}};t.getMessageNotify(n,function(t){e.notifyMethod=t.data.messageTypeItems,e.notifyNodeType=t.data.children,$(":checkbox").attr("disabled",!0),e.$apply()})})}]);