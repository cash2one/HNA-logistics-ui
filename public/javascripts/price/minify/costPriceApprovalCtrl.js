var addCostPriceUrl="#/priceDetail?module=costPriceApproval&q=price",controller={$scope:null,service:null,tableService:null,initViewButton:function(e){$.extend(!0,e.viewButton,{isAdd:!1,isDelete:!1,isCopy:!1,isSubmitVerify:!1,isVerifyOk:!1,isNoPassDraft:!1,isShowVerifyList:!1,isShowStatusTableCell:!0,isShowStartState:!0,isTabList:!0,isShowCheckBox:!1,isShowOperAreaLine:!1,isShowWeightAndArea:!0})},loadCostPriceApprovalData:function(){var e=this,t=this.$scope;t.pricePlanQ=t.pricePlan,t.belongServiceQ=t.belongServiceId,t.startAddressQ=t.startAddress,t.belongProductQ=t.belongProduct,t.tableModel.restData.status=t.useStateId;var o={urlParams:t.tableModel.restData};this.tableService.getTable(t.tableModel.restURL,o,function(s){t.q=t.tableModel.restData.q,t.isShowIcon=!0,0===s.errorCode&&(t.tableModel=e.tableService.table(t.tableModel,o,s),setTimeout(function(){t.setScroll(),$(window).on("resize",t.setScroll),t.$apply(),$(".table-box").focus()},100))})},initPage:function(){function e(o,s){if(0!=$scope.tableModel.selectNumber&&0!=$(".table-box tbody tr").length){var a=[],c=t.tableService.getSelectTable($scope.tableModel.tableBody);if(!c.length)return accountView.promptBox({isDelay:!0,contentDelay:Lang.getValByKey("price","price_prompt_delay_tip"),type:"errer",manualClose:!0}),!1;angular.forEach(c,function(e){a.push(e.uid)}),a.seatParams=s?{confirmed:"isconfirmed=true"}:{confirmed:"isconfirmed=false"},o(a,function(s){0===s.errorCode?($(document).promptBox({isDelay:!0,contentDelay:s.msg,type:"success",time:3e3}),$(document).promptBox("closePrompt"),t.loadCostPriceApprovalData()):207001==s.errorCode?$(document).promptBox({title:Lang.getValByKey("common","common_prompt_title"),type:"success",content:{tip:s.msg},operation:[{type:"submit",description:Lang.getValByKey("common","common_pagination_confirm"),application:"confirm",operationEvent:function(){$(document).promptBox("closePrompt"),e(o,!0)}}]}):$(document).promptBox({isDelay:!0,contentDelay:s.msg,type:"errer",manualClose:!0})})}else $(document).promptBox({isDelay:!0,contentDelay:Lang.getValByKey("price","price_prompt_delay_tip"),type:"errer",manualClose:!0})}var t=this;$scope=this.$scope,$scope.useStateId=2,$scope.tableModel={tableHeader:[Lang.getValByKey("price","price_id"),Lang.getValByKey("price","price_plan"),Lang.getValByKey("price","price_code"),Lang.getValByKey("price","price_belong_service"),Lang.getValByKey("price","price_start_address"),Lang.getValByKey("price","price_goods_type"),Lang.getValByKey("price","price_valuation_currency"),Lang.getValByKey("price","price_account_type"),Lang.getValByKey("price","price_start_time"),Lang.getValByKey("price","price_end_time"),Lang.getValByKey("price","price_status")],tableHeaderSize:["5%","13%","6%","14%","8%","6%","7%","6%","12%","12%","6%"],tableBody:[],restURL:"logistics.getCostPriceList",restData:{q:"",pageIndex:1,pageSize:10,unfilled:!0,orderby:"submittime",asc:!0},selectNumber:0,selectFlag:!1},this.loadCostPriceApprovalData(),$scope.search=function(){$scope.tableModel.restData.feeTypeCode=$scope.costTypeStartCode,$scope.tableModel.restData.status=$scope.useStateId,$scope.tableModel.restData.biz=$scope.belongServiceId,$scope.tableModel.restData.q=$scope.pricePlan,$scope.tableModel.restData.pageIndex=1,$scope.tableModel.restData.currencyId=$scope.valuationCurrencyId,$scope.tableModel.restData.feeTypeId=$scope.costTypeEndId,$scope.tableModel.restData.settleMentId=$scope.accountTypeId,$scope.tableModel.restData.starts=$scope.startAddress,$scope.tableModel.restData.cargoTypeCode=$scope.goodsTypeId,$scope.tableModel.restData.startEffectTime=$("#start-time").val(),$scope.tableModel.restData.endEffectTime=$("#end-time").val(),t.loadCostPriceApprovalData()},$scope.resetData=function(){$scope.costTypeStartCode="",$scope.pricePlan="",$scope.useStateId="",$scope.useState="",$scope.verifyStateId="",$scope.verifyState="",$scope.accountType="",$scope.accountTypeId="",$scope.costTypeStart="",$scope.costTypeEnd="",$scope.costTypeEndId="",$scope.valuationCurrency="",$scope.valuationCurrencyId="",$scope.startAddress="",$scope.goodsType="",$scope.goodsTypeId="",$("#start-time").val(""),$("#end-time").val(""),$scope.belongService="",$scope.belongServiceId="",$scope.q="";var e=$scope.getTabType();1==e?$scope.useStateId=2:2==e&&($scope.useStateId=3,$scope.useState=Lang.getValByKey("price","price_verify_ok")),$scope.search()},$scope.switchTab=function(e,o){var s=$(e.target);s.hasClass("tab-active")||($(".tab-active").removeClass("tab-active"),s.addClass("tab-active"),1==o?($scope.viewButton.isShowUseState=!1,$scope.viewButton.isShowStartUse=!1,$scope.viewButton.isShowStopUse=!1,$scope.viewButton.isVerifyOk=!1,$scope.viewButton.isNoPassDraft=!1,$scope.viewButton.isShowStatusTableCell=!0,$(".select-container").css("display","none"),$scope.resetData(),$scope.useStateId=2,$scope.tableModel.restData.asc=!0,$scope.tableModel.tableHeaderSize=["5%","13%","6%","14%","8%","6%","7%","6%","12%","12%","6%"],$scope.tableModel.restData.orderby="submittime",t.loadCostPriceApprovalData()):2==o&&($scope.viewButton.isShowUseState=!0,$scope.viewButton.isShowStartUse=!1,$scope.viewButton.isShowStopUse=!1,$scope.viewButton.isVerifyOk=!1,$scope.viewButton.isNoPassDraft=!1,$scope.viewButton.isShowStatusTableCell=!1,$(".select-container").css("display","none"),$scope.resetData(),$scope.useStateId=3,$scope.useState=Lang.getValByKey("price","price_verify_ok"),$scope.tableModel.restData.asc=!1,$scope.tableModel.tableHeaderSize=["5%","13%","6%","14%","8%","6%","7%","6%","12%","12%","6%"],$scope.tableModel.restData.orderby="submittime",t.loadCostPriceApprovalData()))},$scope.verifyOk=function(){$scope.showConfirmWindow(function(){e(t.service.verifyPass)},Lang.getValByKey("price","price_confirm_verify_ok_tips"))},$scope.nopassDraft=function(){$scope.showConfirmWindow(function(){e(t.service.nopassDraft)},Lang.getValByKey("price","price_confirm_nppass_tips"))},$scope.startUse=function(){$scope.showConfirmWindow(function(){e(t.service.startUse)},Lang.getValByKey("price","price_confirm_start_use_tips"))},$scope.stopUse=function(){$scope.showConfirmWindow(function(){e(t.service.stopUse)},Lang.getValByKey("price","price_confirm_stop_use_tips"))},$scope.editCurrentPrice=function(e){var t=$scope.getTabType();location.href=addCostPriceUrl+"&uid="+e+"&type="+t}},init:function(e,t,o){this.initViewButton(e),this.$scope=e,this.tableService=o,this.service=t,this.initPage()}};