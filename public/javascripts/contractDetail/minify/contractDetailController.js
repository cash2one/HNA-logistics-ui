easySpa.use(["widget/select","widget/prompt","widget/richText"],function(){app.controller("contractDetailCtrl",["$scope","contractDetailService","contractDetailView",function(t,e,a){function r(){t.editContractTitle=!1,t.contractorTitle="",t.partAName="",t.partBName="",t.partAAddr="",t.partBAddr="",t.partAPhone="",t.partBPhone="",t.partABankAccount="",t.partBBankAccount="",t.partABankName="",t.partBBankName="",t.userId=cookie.get("userId"),t.id=t.id||easySpa.queryUrlValByKey("id"),t.tempId=easySpa.queryUrlValByKey("tempId"),t.id||(t.id=0),0!=t.id?(t.isEdit=!1,t.editContractTitle=!1,$(".w-e-text").attr("contenteditable","false"),e.getContractById(t.id,function(e){if(0==e.errorCode){var a=e.data;t.contractorTitle=a.title,t.templateName=a.templateName,t.serviceTypeCode=a.serviceType,t.serviceType=a.serviceTypeName,$(".w-e-text").html(a.content),t.partAName=a.firstContractorDto.name,t.partAAddr=a.firstContractorDto.address,t.partAPhone=a.firstContractorDto.contact,t.partABankAccount=a.firstContractorDto.bankAccount,t.partABankName=a.firstContractorDto.bankName,t.partBName=a.secondContractorDto.name,t.partBAddr=a.secondContractorDto.address,t.partBPhone=a.secondContractorDto.contact,t.partBBankAccount=a.secondContractorDto.bankAccount,t.partBBankName=a.secondContractorDto.bankName,t.isSelfTemplate=t.userId==a.createUserId,t.contractStatus=a.status,t.editContractTitle=!1,t.fileUrl=a.fileUrl}})):(t.isEdit=!0,t.editContractTitle=!0,t.isSelfTemplate=!0,t.contractStatus=1,t.tempId&&e.getContractTemplateById(t.tempId,function(e){if(0==e.errorCode){var a=e.data;t.contractorTitle=a.title,t.templateName=a.name,t.serviceTypeCode=a.serviceType,t.serviceType=a.serviceTypeName,$(".w-e-text").html(a.content),t.partAName=a.firstContractorDto.name,t.partAAddr=a.firstContractorDto.address,t.partAPhone=a.firstContractorDto.contact,t.partABankAccount=a.firstContractorDto.bankAccount,t.partABankName=a.firstContractorDto.bankName,t.partBName=a.secondContractorDto.name,t.partBAddr=a.secondContractorDto.address,t.partBPhone=a.secondContractorDto.contact,t.partBBankAccount=a.secondContractorDto.bankAccount,t.partBBankName=a.secondContractorDto.bankName}}))}$.extend(t,{initSelect:function(){a.initStateSelect(t)},bindEvent:function(){a.bindEvent(t)}}),t.downLoadContract=function(){$("a")[0]},r(),t.initSelect(),t.bindEvent(),t.cancelDraftContract=function(){r()}}])});