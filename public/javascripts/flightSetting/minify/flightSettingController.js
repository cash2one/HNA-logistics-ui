easySpa.require(["widget/slimscroll","widget/prompt","widget/select","widget/flatpickr","public/common/tableController.js","widget/slides"],function(){app.controller("flightSettingCtrl",["$scope","flightSettingService","flightSettingView","tableService",function(e,t,a,i){function r(){if("false"===e.isSame){var t,a,i=$("#startTime_Mon"),r=$("#startTime_Tue"),n=$("#startTime_Wed"),o=$("#startTime_Thu"),d=$("#startTime_Fri"),l=$("#startTime_Sat"),m=$("#endTime_Mon"),s=$("#endTime_Tue"),T=$("#endTime_Wed"),g=$("#endTime_Thu"),p=$("#endTime_Fri"),c=$("#endTime_Sat");e.startTime_Sun=t=$("#startTime_Sun").val(),e.endTime_Sun=a=$("#endTime_Sun").val(),i.val()||r.val()||n.val()||o.val()||d.val()||l.val()||(e.startTime_Sat=e.startTime_Fri=e.startTime_Thu=e.startTime_Wed=e.startTime_Tue=e.startTime_Mon=e.startTime_Sun,i.val(t),r.val(t),n.val(t),o.val(t),d.val(t),l.val(t)),m.val()||s.val()||T.val()||g.val()||p.val()||c.val()||(e.endTime_Sat=e.endTime_Fri=e.endTime_Thu=e.endTime_Wed=e.endTime_Tue=e.endTime_Mon=e.endTime_Sun,m.val(a),s.val(a),T.val(a),g.val(a),p.val(a),c.val(a)),e.startTime_Mon=i.val(),e.startTime_Tue=r.val(),e.startTime_Wed=n.val(),e.startTime_Thu=o.val(),e.startTime_Fri=d.val(),e.startTime_Sat=l.val(),e.endTime_Mon=m.val(),e.endTime_Tue=s.val(),e.endTime_Wed=T.val(),e.endTime_Thu=g.val(),e.endTime_Fri=p.val(),e.endTime_Sat=c.val(),e.$apply()}"true"===e.isSame&&(e.startTime_day=$("#startTime_day").val(),e.endTime_day=$("#endTime_day").val(),e.$apply())}function n(e){return g="true"===e?["startTime_day","endTime_day"]:["startTime_Sun","endTime_Sun","startTime_Mon","endTime_Mon","startTime_Tue","endTime_Tue","startTime_Wed","endTime_Wed","startTime_Thu","endTime_Thu","startTime_Fri","endTime_Fri","startTime_Sat","endTime_Sat"]}function o(){p.defaultDate="",e.flatpickrId.forEach(function(e,t){var a="#"+e;$(a).val()&&$(a).val(""),$(a).flatpickr(p)}),"true"===e.isSame?(e.startTime_day="",e.endTime_day="",e.$apply()):(e.startTime_Sun="",e.endTime_Sun="",e.startTime_Mon="",e.endTime_Mon="",e.startTime_Tue="",e.endTime_Tue="",e.startTime_Wed="",e.endTime_Wed="",e.startTime_Thu="",e.endTime_Thu="",e.startTime_Fri="",e.endTime_Fri="",e.startTime_Sat="",e.endTime_Sat="",e.$apply())}function d(){angular.forEach(e.tableModel.tableBody,function(t,a){e.tableModel.tableBody[a].flightTimes="",t.isSame?t.startTime&&t.endTime&&(e.tableModel.tableBody[a].flightTimes=t.startTime+"-"+t.endTime):((t.details[0].startTime||t.details[1].arriveTime)&&(e.tableModel.tableBody[a].flightTimes+=t.details[0].startTime+"-"+t.details[1].arriveTime+"，"),(t.details[2].startTime||t.details[3].arriveTime)&&(e.tableModel.tableBody[a].flightTimes+=t.details[2].startTime+"-"+t.details[3].arriveTime+"，"),(t.details[4].startTime||t.details[5].arriveTime)&&(e.tableModel.tableBody[a].flightTimes+=t.details[4].startTime+"-"+t.details[5].arriveTime+"，"),(t.details[6].startTime||t.details[7].arriveTime)&&(e.tableModel.tableBody[a].flightTimes+=t.details[6].startTime+"-"+t.details[7].arriveTime+"，"),(t.details[8].startTime||t.details[9].arriveTime)&&(e.tableModel.tableBody[a].flightTimes+=t.details[8].startTime+"-"+t.details[9].arriveTime+"，"),(t.details[10].startTime||t.details[11].arriveTime)&&(e.tableModel.tableBody[a].flightTimes+=t.details[10].startTime+"-"+t.details[11].arriveTime+"，"),(t.details[12].startTime||t.details[13].arriveTime)&&(e.tableModel.tableBody[a].flightTimes+=t.details[12].startTime+"-"+t.details[13].arriveTime))})}function l(e,t){return t||(t=1),e=e||"",{urlParams:{q:e,pageIndex:t,pageSize:10,includeAllAudit:!0},isAsync:!0}}function m(e,t,a){t=t.data;for(var i=0;i<t.length;i++){var r=t[i].name;if($.trim(r)==$.trim(e)||$.trim(t[i].name)==$.trim(e))return a?t[i].code:t[i].id}}function s(e,t){e.forEach(function(e,a){var i="#"+e;a%2==0?($(i).val(t[a].startTime),p.defaultDate=t[a].startTime):($(i).val(t[a].arriveTime),p.defaultDate=t[a].arriveTime),$(i).flatpickr(p)})}function T(t){return t?(e.startTime_day||e.baseInfoForm.startTime_day.$setDirty(),e.endTime_day||e.baseInfoForm.endTime_day.$setDirty()):(e.startTime_Sun||e.baseInfoForm.startTime_Sun.$setDirty(),e.endTime_Sun||e.baseInfoForm.endTime_Sun.$setDirty(),e.startTime_Mon||e.baseInfoForm.startTime_Mon.$setDirty(),e.endTime_Mon||e.baseInfoForm.endTime_Mon.$setDirty(),e.startTime_Tue||e.baseInfoForm.startTime_Tue.$setDirty(),e.endTime_Tue||e.baseInfoForm.endTime_Tue.$setDirty(),e.startTime_Wed||e.baseInfoForm.startTime_Wed.$setDirty(),e.endTime_Wed||e.baseInfoForm.endTime_Wed.$setDirty(),e.startTime_Thu||e.baseInfoForm.startTime_Thu.$setDirty(),e.endTime_Thu||e.baseInfoForm.endTime_Thu.$setDirty(),e.startTime_Fri||e.baseInfoForm.startTime_Fri.$setDirty(),e.endTime_Fri||e.baseInfoForm.endTime_Fri.$setDirty(),e.startTime_Sat||e.baseInfoForm.startTime_Sat.$setDirty(),e.endTime_Sat||e.baseInfoForm.endTime_Sat.$setDirty()),console.log("$valid===",e.baseInfoForm.$valid),e.baseInfoForm.$valid}e.flightSetting={id:""},e.conf=[],e.airportNames=[];var g=[],p={enableTime:!0,noCalendar:!0,enableSeconds:!1,time_24hr:!0,dateFormat:"H:i",defaultDate:"",minuteIncrement:1,defaultHour:12,onOpen:function(e,t,a){t?a.resetDefaultDate(t):a.setDate("12:00",!1,"H:i")},onClose:function(e,t){r()},defaultMinute:0};e.changeRadio=function(t){e.flatpickrId=n(t),o()},e.getLanguage=function(){t.getLanguage(function(t){0===t.errorCode&&(e.language=t.data)})},e.getLanguage(),$("#startTime").flatpickr(p),$("#endTime").flatpickr(p),e.tableModel={tableHeader:[Lang.getValByKey("common","common_thead_number"),Lang.getValByKey("flightSetting","flightSetting_page_name"),Lang.getValByKey("flightSetting","flightSetting_fly_start"),Lang.getValByKey("flightSetting","flightSetting_fly_end"),Lang.getValByKey("flightSetting","flightSetting_fly_time"),Lang.getValByKey("flightSetting","flightSetting_fly_type"),Lang.getValByKey("flightSetting","flightSetting_fly_company"),Lang.getValByKey("flightSetting","flightSetting_line_Type")],tableBody:[],restURL:"logistics.getFlightSettingTable",restData:{q:"",startAirportId:"",endAirportId:"",startTime:"",endTime:"",pageIndex:1,pageSize:10,sort:""},selectNumber:0,selectFlag:!1},e.getTable=function(t){e.q=e.tableModel.restData.q,e.tableModel.restData.startAirportId=e.searchStartFlightCode,e.tableModel.restData.endAirportId=e.searchEndFlightCode,t&&(e.tableModel.restData.pageIndex=1);var a={urlParams:e.tableModel.restData};i.getTable(e.tableModel.restURL,a,function(t){0===t.errorCode&&(e.tableModel=i.table(e.tableModel,a,t),d(),e.nestFlightSettingForm=!1,setTimeout(function(){var e=$(".flightSetting-table-page").height()-330;$(".table-container tbody").slimscroll({height:e}),$(window).resize(function(){e=$(".flightSetting-table-page").height()-330,$(".table-container tbody").slimscroll({height:e})})},10))})},e.getTable(),e.$watch("tableModel",function(e,t){e!==t&&d()},!0),e.clearData=function(){p.defaultDate="",$("#startTime").flatpickr(p),$("#endTime").flatpickr(p),e.tableModel.restData.q="",e.q="",e.tableModel.restData.pageIndex=1,e.tableModel.restData.startAirportId="",e.tableModel.restData.endAirportId="",e.tableModel.restData.startTime="",e.tableModel.restData.endTime="",e.searchStartFlight="",e.searchEndFlight="",e.searchStartFlightCode="",e.searchEndFlightCode="",e.getTable()},e.del=function(){var r={},n=[],o=i.getSelectTable(e.tableModel.tableBody);if(!o.length)return a.promptBox({isDelay:!0,contentDelay:Lang.getValByKey("common","common_code_noSelected"),type:"errer",manualClose:!0}),!1;angular.forEach(o,function(e){n.push(e.id)}),r={urlParams:n};var d={title:Lang.getValByKey("common","common_prompt_title"),type:"warning",content:{tip:Lang.getValByKey("flightSetting","flightSetting_code_modelDelTips")},operation:[{type:"submit",description:Lang.getValByKey("common","common_page_delete"),application:"delete",operationEvent:function(){t.del(r,function(t){a.promptBox("closePrompt"),0===t.errorCode?(a.promptBox({isDelay:!0,contentDelay:t.msg,type:"success"}),e.getTable(),e.$apply()):a.promptBox({isDelay:!0,contentDelay:t.msg,type:"errer",manualClose:!0})})}}]};a.promptBox(d)};var c,_,h,f,u,y;e.addAirportTypes=[{code:1,name:Lang.getValByKey("flightSetting","flightSetting_self_airLine")},{code:2,name:Lang.getValByKey("flightSetting","flightSetting_SPA_airLine")},{code:3,name:Lang.getValByKey("flightSetting","flightSetting_car_airLine")}],e.initSelectList=function(){var a={urlParams:{q:"",pageIndex:1,pageSize:10},isAsync:!0};e.searchStartFlights=e.searchEndFlights=t.getAirportShort(a),e.addFlightCompanys=t.getCarrierCompanyShort(a),e.addFlightTypes=t.getAirplaneModels(a),e.addFlightLines=t.getAirLineShort(a),c=selectFactory({data:e.searchStartFlights,isSearch:!0,closeLocalSearch:!0,id:"search-start",pagination:!0,searchPlaceHoder:"请输入名称或三字码",onSearchValueChange:function(t,a,i){e.searchStartFlights=e.getAirportData(a,i),t.setData(e.searchStartFlights)},attrTextModel:function(t,a){e.searchStartFlightCode=m(t,a),e.searchStartFlight=t,e.searchStartFlight==e.searchEndFlight&&($("#search-start").val(""),e.searchStartFlight=""),e.$apply()}}),_=selectFactory({data:e.searchEndFlights,isSearch:!0,id:"search-end",pagination:!0,closeLocalSearch:!0,searchPlaceHoder:"请输入名称或三字码",onSearchValueChange:function(t,a,i){e.searchEndFlights=e.getAirportData(a,i),t.setData(e.searchEndFlights)},attrTextModel:function(t,a){e.searchEndFlightCode=m(t,a),e.searchEndFlight=t,e.searchEndFlight==e.searchStartFlight&&($("#search-end").val(""),e.searchEndPort=""),e.$apply()}}),h=selectFactory({data:e.addFlightCompanys,isSearch:!0,id:"flightCompany",pagination:!0,searchPlaceHoder:"请输入名称或二字码",closeLocalSearch:!0,defaultText:Lang.getValByKey("common","common_select_tips"),onSearchValueChange:function(t,a,i){e.addFlightCompanys=e.getCarrierCompanyData(a,i),t.setData(e.addFlightCompanys)},attrTextModel:function(t,a){e.flightCompanyCode=m(t,a),e.flightCompany=t,e.$apply()}}),f=selectFactory({data:e.addFlightTypes,isSearch:!0,id:"flightType",pagination:!0,closeLocalSearch:!0,searchPlaceHoder:"请输入名称或四字码",defaultText:Lang.getValByKey("common","common_select_tips"),onSearchValueChange:function(t,a,i){e.addFlightTypes=e.getAirplaneModelData(a,i),t.setData(e.addFlightTypes)},attrTextModel:function(t,a){e.flightTypeCode=m(t,a),e.flightType=t,e.$apply()}}),u=selectFactory({data:e.addFlightLines,isSearch:!0,id:"flightLine",pagination:!0,closeLocalSearch:!0,searchPlaceHoder:"请输入名称或编码",defaultText:Lang.getValByKey("common","common_select_tips"),onSearchValueChange:function(t,a,i){e.addFlightLines=e.getAirlineData(a,i),t.setData(e.addFlightLines)},attrTextModel:function(a,i){e.flightLineCode=m(a,i),e.flightLine=a,t.getAirLineDetail({seatParams:{id:e.flightLineCode?e.flightLineCode:""}},function(t){t&&0===t.errorCode&&(e.airportName=t.data.airports[0].airportName+" - "+t.data.airports[t.data.airports.length-1].airportName,e.airportTriadCode=t.data.airports[0].airportTriadCode+" - "+t.data.airports[t.data.airports.length-1].airportTriadCode,e.startAirportId=t.data.airports[0].airportId,e.arriveAirportId=t.data.airports[t.data.airports.length-1].airportId,e.baseInfoForm.$valid=!1,"true"===e.isSame?(e.startTime_day="",e.endTime_day="",e.$apply()):(e.startTime_Sun="",e.endTime_Sun="",e.startTime_Mon="",e.endTime_Mon="",e.startTime_Tue="",e.endTime_Tue="",e.startTime_Wed="",e.endTime_Wed="",e.startTime_Thu="",e.endTime_Thu="",e.startTime_Fri="",e.endTime_Fri="",e.startTime_Sat="",e.endTime_Sat="",e.$apply()),e.changeRadio(e.isSame))})}}),y=selectFactory({data:{data:e.addAirportTypes},id:"airportType",isUsePinyin:!0,defaultText:"",attrTextModel:function(t,a){e.airportTypeId=m(t,a,!0),e.airportType=t,e.$apply()}})},e.getAirportData=function(e,a){var i=l(e,a),r=t.getAirportShort(i);return angular.forEach(r.data,function(e,t){e.name=e.triadCode+"("+e.name+")"}),r},e.getAirlineData=function(e,a){var i=l(e,a),r=t.getAirLineShort(i);return angular.forEach(r.data,function(e,t){e.name+="("+e.code+")"}),r},e.getCarrierCompanyData=function(e,a){var i=l(e,a),r=t.getCarrierCompanyShort(i);return angular.forEach(r.data,function(e,t){e.name+="("+e.figureCode+")"}),r},e.getAirplaneModelData=function(e,a){var i=l(e,a),r=t.getAirplaneModels(i);return angular.forEach(r.data,function(e,t){e.name+="("+e.icao+")"}),r},e.goBack=function(){e.editable?(e.flightSetting.id="",e.validateCodeError=!1,e.getTable()):$(document).promptBox({title:Lang.getValByKey("common","common_prompt_title"),type:"warning",content:{tip:Lang.getValByKey("common","common_back_confirm")},cancelDescription:Lang.getValByKey("common","common_back_no"),operation:[{type:"submit",application:"delete",description:Lang.getValByKey("common","common_back_yes"),operationEvent:function(){e.flightSetting.id="",e.validateCodeError=!1,e.clearData(),e.$apply(),$(document).promptBox("closePrompt")}}]})},e.cancelFightSetting=function(){e.isEdit?(e.editable=!0,e.flightSettingDetail(e.flightSetting.id)):(e.nestFlightSettingForm=!1,e.validateCodeError=!1)},e.add=function(){e.baseInfoForm.$setPristine(),e.baseInfoForm.$setUntouched(),e.conf=[],e.nestFlightSettingForm=!0,e.editable=!1,e.isEdit=!1,e.isSame="true",e.isStopOver="false",e.flatpickrId=n("true"),e.flightCode="",e.flightLineCode="",e.flightLine="",e.flightCompanyCode="",e.flightCompany="",e.flightTypeCode="",e.flightType="",e.airportName="",e.airportTriadCode="",e.startAirportId="",e.arriveAirportId="",e.startTime="",e.arriveTime="",e.sun_startTime="",e.sun_arriveTime="",e.mon_startTime="",e.mon_arriveTime="",e.tue_startTime="",e.tue_arriveTime="",e.wed_startTime="",e.wed_arriveTime="",e.thu_startTime="",e.thu_arriveTime="",e.fri_startTime="",e.fri_arriveTime="",e.sat_startTime="",e.sat_arriveTime="",e.airportType=e.addAirportTypes[0].name,e.airportTypeId=e.addAirportTypes[0].code},e.flightSettingDetail=function(a){e.baseInfoForm.$setPristine(),e.baseInfoForm.$setUntouched(),e.flightSetting.id=a,e.nestFlightSettingForm=!0,e.editable=!0;var i={seatParams:{id:a}};t.getDetail(i,function(t){if(0===t.errorCode){e.flightCode=t.data.code,e.flightLineCode=t.data.airlineId,e.flightLine=t.data.airlineName,e.flightCompanyCode=t.data.carrierCompanyId,e.flightCompany=t.data.carrierCompanyName,e.flightTypeCode=t.data.airplaneModelId,e.flightType=t.data.airplaneModelName,e.airportTypeId=t.data.type,e.airportType=t.data.typeName;var a=t.data.details;e.airportName=a[0].airportName+" - "+a[1].airportName,e.airportTriadCode=a[0].airportTriadCode+" - "+a[1].airportTriadCode,t.data.isSame?(e.isSame="true",e.startTime=a[0].startTime,e.arriveTime=a[1].arriveTime):(e.isSame="false",e.sun_startTime=a[0].startTime,e.sun_arriveTime=a[1].arriveTime,e.mon_startTime=a[2].startTime,e.mon_arriveTime=a[3].arriveTime,e.tue_startTime=a[4].startTime,e.tue_arriveTime=a[5].arriveTime,e.wed_startTime=a[6].startTime,e.wed_arriveTime=a[7].arriveTime,e.thu_startTime=a[8].startTime,e.thu_arriveTime=a[9].arriveTime,e.fri_startTime=a[10].startTime,e.fri_arriveTime=a[11].arriveTime,e.sat_startTime=a[12].startTime,e.sat_arriveTime=a[13].arriveTime),t.data.isStopOver?e.isStopOver="true":e.isStopOver="false"}})},e.editFlightSetting=function(){e.baseInfoForm.$setPristine(),e.baseInfoForm.$setUntouched(),e.nestFlightSettingForm=!0,e.isEdit=!0,e.editable=!1;var a={seatParams:{id:e.flightSetting.id}};t.getDetail(a,function(t){if(0===t.errorCode){e.flightCode=t.data.code,e.flightLineCode=t.data.airlineId,e.flightLine=t.data.airlineName,e.flightCompanyCode=t.data.carrierCompanyId,e.flightCompany=t.data.carrierCompanyName,e.flightTypeCode=t.data.airplaneModelId,e.flightType=t.data.airplaneModelName,e.airportTypeId=t.data.type,e.airportType=t.data.typeName;var a=t.data.details;e.startAirportId=a[0].airportId,e.arriveAirportId=a[1].airportId,t.data.isSame?(e.isSame="true",s(n("true"),a),e.startTime_day=a[0].startTime,e.endTime_day=a[1].arriveTime):(e.isSame="false",s(n("false"),a),e.startTime_Sun=a[0].startTime,e.endTime_Sun=a[1].arriveTime,e.startTime_Mon=a[2].startTime,e.endTime_Mon=a[3].arriveTime,e.startTime_Tue=a[4].startTime,e.endTime_Tue=a[5].arriveTime,e.startTime_Wed=a[6].startTime,e.endTime_Wed=a[7].arriveTime,e.startTime_Thu=a[8].startTime,e.endTime_Thu=a[9].arriveTime,e.startTime_Fri=a[10].startTime,e.endTime_Fri=a[11].arriveTime,e.startTime_Sat=a[12].startTime,e.endTime_Sat=a[13].arriveTime),t.data.isStopOver?e.isStopOver="true":e.isStopOver="false"}})},e.submitFightSetting=function(){var i,r;if(i="true"===e.isSame,r="true"===e.isStopOver,i?(e.startTime_day||(e.startTime_day=$("#startTime_day").val()),e.endTime_day||(e.endTime_day=$("#endTime_day").val()),e.conf=[{airportId:e.startAirportId,startTime:e.startTime_day},{airportId:e.arriveAirportId,arriveTime:e.endTime_day}]):(e.startTime_Sun||(e.startTime_Sun=$("#startTime_Sun").val()),e.endTime_Sun||(e.endTime_Sun=$("#endTime_Sun").val()),e.startTime_Mon||(e.startTime_Mon=$("#startTime_Mon").val()),e.endTime_Mon||(e.endTime_Mon=$("#endTime_Mon").val()),e.startTime_Tue||(e.startTime_Tue=$("#startTime_Tue").val()),e.endTime_Tue||(e.endTime_Tue=$("#endTime_Tue").val()),e.startTime_Wed||(e.startTime_Wed=$("#startTime_Wed").val()),e.endTime_Wed||(e.endTime_Wed=$("#endTime_Wed").val()),e.startTime_Thu||(e.startTime_Thu=$("#startTime_Thu").val()),e.endTime_Thu||(e.endTime_Thu=$("#endTime_Thu").val()),e.startTime_Fri||(e.startTime_Fri=$("#startTime_Fri").val()),e.endTime_Fri||(e.endTime_Fri=$("#endTime_Fri").val()),e.startTime_Sat||(e.startTime_Sat=$("#startTime_Sat").val()),e.endTime_Sat||(e.endTime_Sat=$("#endTime_Sat").val()),e.conf=[{airportId:e.startAirportId,startTime:e.startTime_Sun},{airportId:e.arriveAirportId,arriveTime:e.endTime_Sun},{airportId:e.startAirportId,startTime:e.startTime_Mon},{airportId:e.arriveAirportId,arriveTime:e.endTime_Mon},{airportId:e.startAirportId,startTime:e.startTime_Tue},{airportId:e.arriveAirportId,arriveTime:e.endTime_Tue},{airportId:e.startAirportId,startTime:e.startTime_Wed},{airportId:e.arriveAirportId,arriveTime:e.endTime_Wed},{airportId:e.startAirportId,startTime:e.startTime_Thu},{airportId:e.arriveAirportId,arriveTime:e.endTime_Thu},{airportId:e.startAirportId,startTime:e.startTime_Fri},{airportId:e.arriveAirportId,arriveTime:e.endTime_Fri},{airportId:e.startAirportId,startTime:e.startTime_Sat},{airportId:e.arriveAirportId,arriveTime:e.endTime_Sat}]),e.flightCode||e.baseInfoForm.flightCode.$setDirty(),e.flightCompany||e.baseInfoForm.flightCompany.$setDirty(),e.flightType||e.baseInfoForm.flightType.$setDirty(),e.flightLine||e.baseInfoForm.flightLine.$setDirty(),e.flightLineCode||e.baseInfoForm.flightLineCode.$setDirty(),!T(i)||!e.baseInfoForm.$valid||e.validateCodeError)return void scrollToErrorView($(".from-box"));var n={urlParams:{code:e.flightCode,airlineId:e.flightLineCode,carrierCompanyId:e.flightCompanyCode,type:e.airportTypeId,airplaneModelId:e.flightTypeCode,isSame:i,isStopOver:r,details:e.conf}};e.flightSetting.id?(n.seatParams={id:e.flightSetting.id},t.saveEdit(n,function(t){t&&0===t.errorCode?(a.promptBox({isDelay:!0,contentDelay:t.msg,type:"success"}),e.nestFlightSettingForm=!1,e.getTable(),e.flightSetting.id=""):a.promptBox({isDelay:!0,contentDelay:t.msg,type:"errer",manualClose:!0}),p.defaultDate=""})):t.save(n,function(t){t&&0===t.errorCode?(a.promptBox({isDelay:!0,contentDelay:t.msg,type:"success"}),e.nestFlightSettingForm=!1,e.getTable()):a.promptBox({isDelay:!0,contentDelay:t.msg,type:"errer",manualClose:!0}),p.defaultDate=""})},e.checkFlightsCode=function(){if(e.flightCode){var a={urlParams:{code:e.flightCode,id:e.flightSetting.id?e.flightSetting.id:""}};t.checkFlightsCode(a,function(t){0===t.errorCode?(e.validateCodeError=!1,angular.element($(".validate-code").removeClass("ng-invalid"))):(e.validateCodeError=!0,angular.element($(".validate-code").addClass("ng-invalid")))})}},e.cancelErrorCode=function(){e.validateCodeError=!1,angular.element($(".validate-code").removeClass("ng-invalid"))}}])});