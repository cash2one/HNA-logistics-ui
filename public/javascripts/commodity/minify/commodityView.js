app.factory("commodityView",["$http","$templateCache","$compile",function(t,n,o){function e(){return"?a="+Math.random()}var i={};i.getTpl=function(o){return t.get("/tpl/fragment/commodity/"+o+".html"+e()).then(function(t){if(t.data)return n.put(o+".html",t.data),t.data})};var c=$(document);return i.promptBox=function(t){var n={isDelay:!0,contentDelay:t.msg,time:3e3};0==t.errorCode?n.type="success":n.type="errer",c.promptBox(n),!n.time||c.promptBox("closePrompt")},i.promptMidBox=function(t,n,o,e){c.promptBox({title:t||"提示信息",type:"success",width:"400px",content:{tip:n.msg},operation:[{type:"submit",description:o||Lang.getValByKey("common","common_pagination_confirm"),operationEvent:function(){return e(),!1}}]})},i.resetKeys=function(t,n){for(var o in n)delete t[o]},i.setTableHeight=function(){var t=$("#commodityList .bills").height(),n=$("#tableWrap");n.height(t-n.offset().top+20+"px")},i.goodsTypes=function(t,n,e,i){function c(t,n){var o="<ul>";return t.forEach(function(t){o+='<li><p><input type="radio" style="left:'+(-30-15*n)+'px" name="goodType" ng-click="gchange(\''+t.name+"','"+t.id+'\')" ng-model="goodType" value="'+t.id+'" /><span>'+t.name+"</span></p></li>",t.children&&t.children.length>0&&(o+=c(t.children,n+1))}),o+="</ul>"}var r,a;e.id&&(n.goodType=a=e.id),e.name&&(r=e.name);var p='<div class="good-type" id="goodTypeDiv"><div><strong>选择商品类别</strong><div class="good-type-div">'+c(t,0)+'</div><div class="good-type-btn"><button class="btn btn-primary btn-bill" ng-click="gcancel()">取消</button><button class="btn btn-primary btn-bill" ng-click="gconfirm()">确定</button></div></div></div>',d={gconfirm:function(){i(r,a),n.gcancel()},gcancel:function(){$("#goodTypeDiv").remove()},gchange:function(t,n){r=t,a=n}};n.gconfirm||$.extend(n,d),$("#commodityList").children("#goodTypeDiv").remove(),$("#commodityList").append(o(p)(n))},i}]);