app.factory("tradeOrderSearchView",["$http","$templateCache","$compile",function(n,e,t){function i(){return"?a="+Math.random()}var o={};o.initCalander=function(n){Calander.init({ele:["#startTime","#endTime"],isClear:!0}),n.search.startTime=getBeforeDate(6)+" 00:00:00",n.search.endTime=(new Date).format("yyyy-MM-dd 23:59:59")},o.getTpl=function(t){return n.get("/tpl/fragment/tradeOrders/"+t+".html"+i()).then(function(n){if(n.data)return e.put(t+".html",n.data),n.data})};var c=$(document);return o.promptBox=function(n){var e={isDelay:!0,contentDelay:n.msg,time:3e3};0==n.errorCode?e.type="success":(e.manualClose=!0,e.type="errer"),c.promptBox(e),!e.time||c.promptBox("closePrompt")},o.promptMidBox=function(n,e,t,i,o,a,r){c.promptBox({title:n||"提示信息",type:o||"success",width:"400px",content:{tip:e.msg},cancelDescription:r,operation:[{type:"submit",application:a,description:t||Lang.getValByKey("common","common_pagination_confirm"),operationEvent:function(){return i(),!1}}]})},o.resetKeys=function(n,e){for(var t in e)delete n[t]},o.goodsTypes=function(n,e,i,o){function c(n,e){var t="<ul>";return n.forEach(function(n){t+='<li><p><input type="radio" style="left:'+(-30-15*e)+'px" name="goodType" ng-click="gchange(\''+n.name+"','"+n.id+'\')" ng-model="goodType" value="'+n.id+'" /><span>'+n.name+"</span></p></li>",n.children&&n.children.length>0&&(t+=c(n.children,e+1))}),t+="</ul>"}var a,r;i.id&&(e.goodType=r=i.id),i.name&&(a=i.name);var d='<div class="good-type" id="goodTypeDiv"><div><strong>选择商品类别</strong><div class="good-type-div">'+c(n,0)+'</div><div class="good-type-btn"><button class="btn btn-primary btn-bill" ng-click="gconfirm()">确定</button><button class="btn btn-primary btn-bill" ng-click="gcancel()">取消</button></div></div></div>',l={gconfirm:function(){o(a,r),e.gcancel()},gcancel:function(){$("#goodTypeDiv").remove()},gchange:function(n,e){a=n,r=e}};e.gconfirm||$.extend(e,l),$("#commodityList").append(t(d)(e))},o.initNgSelect=function(n,e,i,o){var c='<ul class="hide">',e=$(e),a=n.$new();i.forEach(function(n){c+="<li ng-click='selectOne("+JSON.stringify(n)+",$event)'>"+n.name+"</li>"}),c+="</ul>",a.selectOne=function(n,t){t.stopPropagation(),e.find("ul").hide(),o(n)},0===e.find("ul").length&&e.append(t(c)(a)),e.find("input").unbind("click").bind("click",function(n){n.stopPropagation();var t=e.find("ul");t.is(":hidden")?t.show():t.hide()}),window.initNgSelect||($(document.body).click(function(){$(".ng-select ul").hide()}),window.initNgSelect=!0)},o}]);